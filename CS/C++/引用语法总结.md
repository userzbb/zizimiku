# C++å¼•ç”¨è¯­æ³•è¯¦è§£

## ğŸ“– ä»€ä¹ˆæ˜¯å¼•ç”¨ï¼Ÿ

å¼•ç”¨ï¼ˆReferenceï¼‰æ˜¯C++ä¸­çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå®ƒä¸ºå·²å­˜åœ¨çš„å˜é‡æä¾›ä¸€ä¸ª**åˆ«å**ã€‚å¼•ç”¨ä¸æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè€Œæ˜¯ç»™ç°æœ‰å¯¹è±¡èµ·çš„å¦ä¸€ä¸ªåå­—ã€‚

## ğŸ”§ åŸºæœ¬è¯­æ³•

### å£°æ˜è¯­æ³•
```cpp
æ•°æ®ç±»å‹& å¼•ç”¨å = è¢«å¼•ç”¨çš„å˜é‡;
```

### ç¤ºä¾‹
```cpp
int x = 10;
int& ref = x;  // refæ˜¯xçš„å¼•ç”¨ï¼ˆåˆ«åï¼‰
```

## ğŸ“‹ å¼•ç”¨çš„æ ¸å¿ƒç‰¹æ€§

### 1. **å¿…é¡»åˆå§‹åŒ–**
```cpp
int& ref;        // âŒ é”™è¯¯ï¼šå¼•ç”¨å¿…é¡»åˆå§‹åŒ–
int& ref = x;    // âœ… æ­£ç¡®ï¼šå¼•ç”¨å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–
```

### 2. **ä¸èƒ½é‡æ–°å¼•ç”¨**
```cpp
int x = 10, y = 20;
int& ref = x;    // refå¼•ç”¨x
ref = y;         // âš ï¸ æ³¨æ„ï¼šè¿™ä¸æ˜¯é‡æ–°å¼•ç”¨ï¼Œè€Œæ˜¯èµ‹å€¼ï¼
                 // è¿™ä¼šå°†yçš„å€¼èµ‹ç»™xï¼Œrefä»ç„¶å¼•ç”¨x
```

### 3. **å…±äº«å†…å­˜åœ°å€**
```cpp
int x = 10;
int& ref = x;
cout << &x << endl;    // åœ°å€ç›¸åŒ
cout << &ref << endl;  // åœ°å€ç›¸åŒ
```

### 4. **ä¸èƒ½ä¸ºç©º**
```cpp
int* ptr = nullptr;    // âœ… æŒ‡é’ˆå¯ä»¥ä¸ºç©º
int& ref = nullptr;    // âŒ å¼•ç”¨ä¸èƒ½ä¸ºç©º
```

## ğŸ¯ å¼•ç”¨çš„ç±»å‹

### 1. **æ™®é€šå¼•ç”¨**
```cpp
int x = 10;
int& ref = x;
ref = 20;        // å¯ä»¥ä¿®æ”¹åŸå˜é‡
```

### 2. **å¸¸é‡å¼•ç”¨ï¼ˆconstå¼•ç”¨ï¼‰**
```cpp
int x = 10;
const int& ref = x;
// ref = 20;     // âŒ é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹
cout << ref;     // âœ… å¯ä»¥è¯»å–

// ç‰¹æ®Šèƒ½åŠ›ï¼šå¯ä»¥ç»‘å®šä¸´æ—¶å¯¹è±¡
const int& temp_ref = 42;         // âœ… å¯ä»¥å¼•ç”¨å­—é¢å€¼
const string& str_ref = "Hello";  // âœ… å¯ä»¥å¼•ç”¨ä¸´æ—¶å¯¹è±¡
```

### 3. **æ•°ç»„å¼•ç”¨**
```cpp
int arr[5] = {1, 2, 3, 4, 5};
int (&arr_ref)[5] = arr;  // æ•°ç»„å¼•ç”¨ï¼Œå¿…é¡»æŒ‡å®šå¤§å°

// âŒ ä¸èƒ½åˆ›å»ºå¼•ç”¨æ•°ç»„
// int& ref_array[3] = {a, b, c};  // é”™è¯¯
```

## ğŸ”„ å‡½æ•°ä¸­çš„å¼•ç”¨

### 1. **å¼•ç”¨ä½œä¸ºå‚æ•°**

#### ä¿®æ”¹åŸå˜é‡
```cpp
void swap(int& a, int& b) {
    int temp = a;
    a = b;
    b = temp;
}

int x = 10, y = 20;
swap(x, y);  // xå’Œyçš„å€¼è¢«äº¤æ¢
```

#### é¿å…æ‹·è´ï¼ˆæé«˜æ•ˆç‡ï¼‰
```cpp
void process(const string& str) {  // ä¸æ‹·è´stringå¯¹è±¡
    cout << str << endl;
}

void process(string str) {         // ä¼šæ‹·è´stringå¯¹è±¡ï¼ˆæ•ˆç‡ä½ï¼‰
    cout << str << endl;
}
```

### 2. **å¼•ç”¨ä½œä¸ºè¿”å›å€¼**

#### å…è®¸é“¾å¼è°ƒç”¨
```cpp
class MyClass {
public:
    MyClass& setValue(int val) {
        value = val;
        return *this;  // è¿”å›è‡ªèº«å¼•ç”¨
    }
};

MyClass obj;
obj.setValue(10).setValue(20);  // é“¾å¼è°ƒç”¨
```

#### âš ï¸ å±é™©ï¼šè¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨
```cpp
int& dangerous() {
    int local = 42;
    return local;  // âŒ å±é™©ï¼localåœ¨å‡½æ•°ç»“æŸæ—¶è¢«é”€æ¯
}

int& safe() {
    static int static_var = 42;
    return static_var;  // âœ… å®‰å…¨ï¼šé™æ€å˜é‡ç”Ÿå‘½å‘¨æœŸé•¿
}
```

## ğŸ†š å¼•ç”¨ vs æŒ‡é’ˆå¯¹æ¯”

| ç‰¹æ€§ | å¼•ç”¨ | æŒ‡é’ˆ |
|------|------|------|
| **åˆå§‹åŒ–** | å¿…é¡»åˆå§‹åŒ– | å¯ä»¥ä¸åˆå§‹åŒ– |
| **é‡æ–°æŒ‡å‘** | ä¸èƒ½é‡æ–°å¼•ç”¨ | å¯ä»¥é‡æ–°æŒ‡å‘ |
| **ç©ºå€¼** | ä¸èƒ½ä¸ºç©º | å¯ä»¥ä¸ºnullptr |
| **è¯­æ³•** | ç›´æ¥ä½¿ç”¨ | éœ€è¦è§£å¼•ç”¨(*) |
| **ç®—æœ¯è¿ç®—** | ä¸æ”¯æŒ | æ”¯æŒ(++, --, +, -) |
| **å†…å­˜å ç”¨** | æ— é¢å¤–å¼€é”€ | éœ€è¦å­˜å‚¨åœ°å€ |

### ç¤ºä¾‹å¯¹æ¯”
```cpp
int x = 10;

// æŒ‡é’ˆæ–¹å¼
int* ptr = &x;
*ptr = 20;        // éœ€è¦è§£å¼•ç”¨
ptr = nullptr;    // å¯ä»¥ä¸ºç©º
ptr++;            // å¯ä»¥ç®—æœ¯è¿ç®—

// å¼•ç”¨æ–¹å¼
int& ref = x;
ref = 20;         // ç›´æ¥ä½¿ç”¨
// ref = nullptr; // âŒ ä¸èƒ½ä¸ºç©º
// ref++;         // âŒ ä¸èƒ½ç®—æœ¯è¿ç®—
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. **ä¼˜å…ˆä½¿ç”¨constå¼•ç”¨ä¼ å‚**
```cpp
// âœ… å¥½ï¼šé¿å…æ‹·è´ï¼Œæ˜ç¡®åªè¯»æ„å›¾
void print(const vector<int>& data) {
    for (const auto& item : data) {
        cout << item << " ";
    }
}

// âŒ å·®ï¼šä¼šæ‹·è´æ•´ä¸ªvector
void print(vector<int> data) {
    for (const auto& item : data) {
        cout << item << " ";
    }
}
```

### 2. **èŒƒå›´forå¾ªç¯ä½¿ç”¨å¼•ç”¨**
```cpp
vector<string> strings = {"hello", "world"};

// âœ… åªè¯»éå†ï¼šé¿å…æ‹·è´
for (const auto& str : strings) {
    cout << str << " ";
}

// âœ… ä¿®æ”¹éå†
for (auto& str : strings) {
    str += "!";
}
```

### 3. **è¿”å›å¼•ç”¨æ”¯æŒé“¾å¼è°ƒç”¨**
```cpp
class Builder {
public:
    Builder& setName(const string& name) {
        this->name = name;
        return *this;
    }
    
    Builder& setAge(int age) {
        this->age = age;
        return *this;
    }
};

Builder builder;
builder.setName("Alice").setAge(25);  // é“¾å¼è°ƒç”¨
```

## âš ï¸ å¸¸è§é™·é˜±

### 1. **æ‚¬ç©ºå¼•ç”¨**
```cpp
int& getBadReference() {
    int local = 42;
    return local;  // âŒ è¿”å›å±€éƒ¨å˜é‡å¼•ç”¨
}
```

### 2. **è¯¯è§£å¼•ç”¨é‡æ–°ç»‘å®š**
```cpp
int x = 10, y = 20;
int& ref = x;
ref = y;  // âš ï¸ è¿™ä¸æ˜¯é‡æ–°å¼•ç”¨ï¼Œè€Œæ˜¯èµ‹å€¼ï¼
```

### 3. **ä¸´æ—¶å¯¹è±¡å¼•ç”¨**
```cpp
string& bad = string("temp");      // âŒ ä¸èƒ½å¼•ç”¨ä¸´æ—¶å¯¹è±¡
const string& good = string("temp"); // âœ… constå¼•ç”¨å¯ä»¥
```

## ğŸš€ ç°ä»£C++ç‰¹æ€§

### C++11: å³å€¼å¼•ç”¨
```cpp
string&& rvalue_ref = string("temp");  // å³å€¼å¼•ç”¨
```

### C++17: ç»“æ„åŒ–ç»‘å®š
```cpp
map<string, int> m = {{"Alice", 25}};
for (const auto& [name, age] : m) {    // ç»“æ„åŒ–ç»‘å®š
    cout << name << ": " << age << endl;
}
```

### å¼•ç”¨åŒ…è£…å™¨
```cpp
#include <functional>
vector<reference_wrapper<int>> refs;
int a = 1, b = 2;
refs.push_back(ref(a));  // åŒ…è£…å¼•ç”¨å­˜å…¥å®¹å™¨
refs.push_back(ref(b));
```

## ğŸ“ æ€»ç»“

å¼•ç”¨æ˜¯C++ä¸­å¼ºå¤§ä¸”é«˜æ•ˆçš„ç‰¹æ€§ï¼š

- **æœ¬è´¨**ï¼šä¸ºç°æœ‰å˜é‡æä¾›åˆ«å
- **ä¼˜åŠ¿**ï¼šè¯­æ³•ç®€æ´ã€æ— é¢å¤–å¼€é”€ã€ç±»å‹å®‰å…¨
- **ç”¨é€”**ï¼šå‡½æ•°å‚æ•°ä¼ é€’ã€è¿”å›å€¼ã€é¿å…æ‹·è´
- **æ³¨æ„**ï¼šå¿…é¡»åˆå§‹åŒ–ã€ä¸èƒ½é‡æ–°ç»‘å®šã€é¿å…æ‚¬ç©ºå¼•ç”¨

æŒæ¡å¼•ç”¨çš„æ­£ç¡®ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ çš„C++ä»£ç æ›´åŠ é«˜æ•ˆå’Œä¼˜é›…ï¼